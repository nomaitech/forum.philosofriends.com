{% extends "base.html" %}

{% block title %}Philosofriends{% endblock %}

{% block content %}
    <ol class="hn-list">
        {% for question in questions %}
            <li class="hn-item{% if question.pinned %} hn-item--pinned{% endif %}">
                <div class="hn-item-header">
                    <div class="hn-vote">
                        {% if user.is_authenticated %}
                            <form method="post" action="{% url 'question_upvote' question.pk %}">
                                {% csrf_token %}
                                <input type="hidden" name="next" value="{{ request.get_full_path }}">
                                <button class="hn-vote-button {% if question.has_voted %}hn-vote-active{% endif %}" type="submit" aria-label="Upvote">
                                    ▲
                                </button>
                            </form>
                        {% else %}
                            <div class="hn-vote-placeholder">▲</div>
                        {% endif %}
                    </div>
                    <div class="hn-item-content">
                        <div class="hn-item-title">
                            {% if question.link %}
                                <a href="{{ question.link }}" rel="noopener noreferrer" target="_blank">
                                    {{ question.title }}
                                    <span class="hn-link-icon" aria-hidden="true">
                                        <svg viewBox="0 0 16 16" focusable="false">
                                            <path d="M10.5 2.5h3v3" />
                                            <path d="M9.2 6.8L13.5 2.5" />
                                            <path d="M7.5 3.5H3.5v9h9v-4" />
                                        </svg>
                                    </span>
                                </a>
                            {% else %}
                                <a href="{% url 'question_detail_slug' question.slug %}">{{ question.title }}</a>
                            {% endif %}
                        </div>
                        <div class="hn-item-meta">
                            {{ question.score|default:0 }} point{{ question.score|pluralize }} · asked by
                            {% if question.author.profile.is_vip %}
                                <a class="hn-user--vip" href="{% url 'profile_detail' question.author.username %}">{{ question.author.username }}</a>
                            {% else %}
                                <a href="{% url 'profile_detail' question.author.username %}">{{ question.author.username }}</a>
                            {% endif %}
                            · {{ question.display_date }} · <a href="{% url 'question_detail_slug' question.slug %}">{{ question.comments.count }} comments</a>
                            {% if question.pinned %}
                                · <span class="hn-pin">pinned</span>
                            {% endif %}
                            {% if question.link %}
                                · <a href="{{ question.link }}" rel="noopener noreferrer" target="_blank">source</a>
                            {% endif %}
                            {% if user.is_authenticated and user.is_superuser %}
                                ·
                                <form class="hn-pin-form" method="post" action="{% url 'question_pin_toggle' question.pk %}">
                                    {% csrf_token %}
                                    <input type="hidden" name="next" value="{{ request.get_full_path }}">
                                    <button class="hn-pin-button" type="submit">
                                        {% if question.pinned %}unpin{% else %}pin{% endif %}
                                    </button>
                                </form>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </li>
        {% empty %}
            <li class="hn-empty">No questions yet. Be the first to ask.</li>
        {% endfor %}
    </ol>
{% endblock %}
